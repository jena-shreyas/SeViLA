type 1
0
1
0
| distributed init (rank 0, world 1): env://
cdr2639:229689:229689 [0] NCCL INFO Bootstrap : Using ib0:172.19.146.76<0>
cdr2639:229689:229689 [0] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
cdr2639:229689:229689 [0] NCCL INFO NET/IB : Using [0]hfi1_0:1/IB ; OOB ib0:172.19.146.76<0>
cdr2639:229689:229689 [0] NCCL INFO Using network IB
NCCL version 2.12.12+cuda11.7
cdr2639:229689:229754 [0] NCCL INFO Setting affinity for GPU 0 to 01
cdr2639:229689:229754 [0] NCCL INFO Channel 00/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 01/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 02/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 03/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 04/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 05/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 06/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 07/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 08/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 09/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 10/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 11/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 12/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 13/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 14/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 15/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 16/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 17/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 18/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 19/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 20/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 21/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 22/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 23/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 24/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 25/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 26/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 27/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 28/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 29/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 30/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Channel 31/32 :    0
cdr2639:229689:229754 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
cdr2639:229689:229754 [0] NCCL INFO Connected all rings
cdr2639:229689:229754 [0] NCCL INFO Connected all trees
cdr2639:229689:229754 [0] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
cdr2639:229689:229754 [0] NCCL INFO comm 0x2ae9cc0090d0 rank 0 nranks 1 cudaDev 0 busId 18000 - Init COMPLETE
Dataset config :  {'data_type': 'videos', 'build_info': {'annotations': {'val': {'url': '/scratch/jenas/BTP/Causal-VidQA/data/sample_data/annotations/val.json', 'storage': '/scratch/jenas/BTP/Causal-VidQA/data/sample_data/annotations/val.json'}}, 'videos': {'storage': '/scratch/jenas/BTP/Causal-VidQA/data/sample_data/videos/'}}, 'vis_processor': {'eval': {'name': 'blip_video_eval', 'n_frms': 32, 'image_size': 224}}, 'text_processor': {'eval': {'name': 'blip_question', 'max_words': 50}}}
Config keys :  dict_keys(['data_type', 'build_info', 'vis_processor', 'text_processor'])
Config : 

 {'data_type': 'videos', 'build_info': {'annotations': {'val': {'url': '/scratch/jenas/BTP/Causal-VidQA/data/sample_data/annotations/val.json', 'storage': '/scratch/jenas/BTP/Causal-VidQA/data/sample_data/annotations/val.json'}}, 'videos': {'storage': '/scratch/jenas/BTP/Causal-VidQA/data/sample_data/videos/'}}, 'vis_processor': {'eval': {'name': 'blip_video_eval', 'n_frms': 32, 'image_size': 224}}, 'text_processor': {'eval': {'name': 'blip_question', 'max_words': 50}}}
Building datasets in base task ...
Inside build processors ...
Config name :  blip_video_eval
Config name :  blip_question
in build() fn, Processors built
Run config :  {'task': 'videoqa', 'lr_sched': 'linear_warmup_cosine_lr', 'init_lr': 1e-05, 'min_lr': 0, 'warmup_lr': 1e-08, 'warmup_steps': 200, 'weight_decay': 0.05, 'max_epoch': 5, 'batch_size_train': 32, 'batch_size_eval': 1, 'num_workers': 0, 'accum_grad_iters': 1, 'max_len': 30, 'min_len': 8, 'num_beams': 5, 'seed': 42, 'output_dir': 'exptscausalvidqa_infer', 'amp': True, 'resume_ckpt_path': None, 'evaluate': False, 'train_splits': ['train'], 'valid_splits': ['val'], 'test_splits': ['val'], 'device': 'cuda', 'world_size': 1, 'dist_url': 'env://', 'distributed': True, 'find_unused_parameters': True, 'rank': 0, 'gpu': 0, 'dist_backend': 'nccl'}
Evaluating ...
evaluate(); Test splits :  ['val']
Obtained frames
Obtained frames
Evaluation  [   0/1000]  eta: 3:12:39    time: 11.5591  data: 1.9507  max mem: 13147
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Evaluation  [  10/1000]  eta: 1:46:43    time: 6.4678  data: 0.6165  max mem: 13155
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Evaluation  [  20/1000]  eta: 1:43:23    time: 6.0690  data: 0.4841  max mem: 13155
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Evaluation  [  30/1000]  eta: 1:40:07    time: 6.0419  data: 0.4452  max mem: 13155
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Evaluation  [  40/1000]  eta: 1:39:04    time: 6.0460  data: 0.4650  max mem: 13155
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Evaluation  [  50/1000]  eta: 1:36:41    time: 5.9733  data: 0.5371  max mem: 13155
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Evaluation  [  60/1000]  eta: 1:35:05    time: 5.8211  data: 0.5005  max mem: 13155
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Evaluation  [  70/1000]  eta: 1:34:39    time: 6.1076  data: 0.5453  max mem: 13155
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames

Error while read file idx
video is: M_hGGjxqB5M_000003_000013
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Evaluation  [  80/1000]  eta: 1:32:53    time: 6.0219  data: 0.5794  max mem: 13155
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Evaluation  [  90/1000]  eta: 1:32:36    time: 6.1020  data: 0.6951  max mem: 13155
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
Obtained frames
result file saved to /scratch/jenas/BTP/SeViLA/lavis/exptscausalvidqa_infer/result/val_epochbest.json
result file saved to /scratch/jenas/BTP/SeViLA/lavis/exptscausalvidqa_infer/result/val_epochbest.json
cdr2639:229689:229689 [0] NCCL INFO comm 0x2ae9cc0090d0 rank 0 nranks 1 cudaDev 0 busId 18000 - Abort COMPLETE
